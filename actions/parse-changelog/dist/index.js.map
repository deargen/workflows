{"version":3,"file":"index.js","sources":["../__vite-browser-external","../src/index.ts"],"sourcesContent":["export default {}","import fs from \"node:fs\"\nimport * as core from \"@actions/core\"\n\nasync function main() {\n  const changelogPath = core.getInput(\"changelog-path\")\n  const targetVersion = core.getInput(\"version\")\n\n  let chglog = \"\"\n\n  try {\n    chglog = await fs.promises.readFile(changelogPath, \"utf8\")\n  } catch (err) {\n    return core.setFailed(`Couldn't find a ${changelogPath}`)\n  }\n\n  const lines = chglog.replace(/\\r/g, \"\").split(\"\\n\")\n\n  // Find the section for the target version.\n  // ## [0.0.2] - 2023-10-02\n  // ... // <- this is the section we want to return\n  // ## [0.0.1] - 2023-10-01\n\n  const versionSectionStart = lines.findIndex((l: string) =>\n    l.startsWith(`## [${targetVersion}]`),\n  )\n\n  if (versionSectionStart < 0) {\n    return core.setFailed(\n      `Couldn't find the section for version ${targetVersion} in the CHANGELOG: no line with \"## [${targetVersion}]\". Please follow the \"Keep a Changelog\" format.`,\n    )\n  }\n\n  let versionSectionEnd = lines.findIndex((l: string, i: number) => {\n    if (i <= versionSectionStart) {\n      return false\n    }\n\n    // The next section starts with \"## [\"\n    if (l.startsWith(\"## [\")) {\n      return true\n    }\n\n    return false\n  })\n\n  if (versionSectionEnd < 0) {\n    // No next section found, so we take the rest of the file.\n    versionSectionEnd = lines.length\n  }\n\n  // Get the lines for the target version section, excluding the header.\n  const versionSectionBody = lines.slice(\n    versionSectionStart + 1,\n    versionSectionEnd,\n  )\n\n  core.setOutput(\"body\", versionSectionBody.join(\"\\n\").trim())\n}\n\nmain()\n"],"names":["core.getInput","core.setFailed","core.setOutput"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAAe,KAAA,CAAA;ACGf,eAAe,OAAO;AACd,QAAA,gBAAgBA,SAAc,gBAAgB;AAC9C,QAAA,gBAAgBA,SAAc,SAAS;AAE7C,MAAI,SAAS;AAET,MAAA;AACF,aAAS,MAAM,GAAG,SAAS,SAAS,eAAe,MAAM;AAAA,WAClD,KAAK;AACZ,WAAOC,SAAe,mBAAmB,aAAa,EAAE;AAAA,EAAA;AAG1D,QAAM,QAAQ,OAAO,QAAQ,OAAO,EAAE,EAAE,MAAM,IAAI;AAOlD,QAAM,sBAAsB,MAAM;AAAA,IAAU,CAAC,MAC3C,EAAE,WAAW,OAAO,aAAa,GAAG;AAAA,EACtC;AAEA,MAAI,sBAAsB,GAAG;AAC3B,WAAOA;AAAAA,MACL,yCAAyC,aAAa,wCAAwC,aAAa;AAAA,IAC7G;AAAA,EAAA;AAGF,MAAI,oBAAoB,MAAM,UAAU,CAAC,GAAW,MAAc;AAChE,QAAI,KAAK,qBAAqB;AACrB,aAAA;AAAA,IAAA;AAIL,QAAA,EAAE,WAAW,MAAM,GAAG;AACjB,aAAA;AAAA,IAAA;AAGF,WAAA;AAAA,EAAA,CACR;AAED,MAAI,oBAAoB,GAAG;AAEzB,wBAAoB,MAAM;AAAA,EAAA;AAI5B,QAAM,qBAAqB,MAAM;AAAA,IAC/B,sBAAsB;AAAA,IACtB;AAAA,EACF;AAEAC,WAAe,QAAQ,mBAAmB,KAAK,IAAI,EAAE,MAAM;AAC7D;AAEA,KAAK;"}